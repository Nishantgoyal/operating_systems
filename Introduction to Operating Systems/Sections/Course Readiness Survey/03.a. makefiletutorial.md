# Makefile Tutorial

- [makefiletutorial](https://makefiletutorial.com/)

## Why do Makefiles exist?

- Used to help decide
  - which parts of a large program need to be recompiled
- Compiling C or C++ files
- Used when you need a series of instructions to run depending on what files have changed

## Simple Makefile

```makefile
hello:
  echo "hello world"
```

## Makefile Syntax

- A Makefile consists of a set of rules
- A rule generally looks like this:

```makefile
targets: prerequisites
  command
  command
  command
```

- The targets are file names
  - separated by spaces
  - Typically, there is only one per rule
- The commands are a series of steps
  - typically used to make the target(s)
  - These need to start with a tab character, _not spaces_
- The prerequisites are also file names
  - separated by spaces
  - Need to exist before the commands for the target are run
  - Also called dependencies

## Variables

- Variables can only be strings
- Reference variables using `${}` or `$()`

```makefile
files = file1 file2
some_file: $(files)
  echo "Look at this variable: " $(files)
  touch some_file
file1:
  touch file1
file2:
  touch file2
```

## Targets

### The `all` target

- Making multiple targets and you want all of them to run
  - Make a `all` target
  - Not a keyword

```makefile
all: one two three
one:
  touch one
two:
  touch two
```

### Multiple targets

- When there are multiple targets for a rule
  - the commands will be run for each target
- `$@` is an automatic variable that contains the target name

```makefile
all: f1.o f2.o
f1.o f2.o:
  echo $@
```
